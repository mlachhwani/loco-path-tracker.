<!DOCTYPE html>
<html>
<head>
    <title>SECR AUDIT - STAGE 02 FINAL</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <style>
        body { margin: 0; font-family: 'Segoe UI', Arial; display: flex; height: 100vh; }
        #sidebar { width: 300px; background: #002f6c; color: white; padding: 20px; z-index: 1000; box-shadow: 2px 0 10px rgba(0,0,0,0.5); }
        #map { flex-grow: 1; background: #f1f1f1; position: relative; }
        .speed-tag { background: white; border: 1px solid #d32f2f; color: #d32f2f; font-size: 10px; font-weight: bold; padding: 1px 3px; border-radius: 2px; text-align: center; box-shadow: 1px 1px 3px rgba(0,0,0,0.4); }
        select, input, button { width: 100%; padding: 12px; margin-bottom: 15px; border-radius: 5px; border: none; font-weight: bold; }
        button { background: #28a745; color: white; cursor: pointer; font-size: 16px; border-bottom: 3px solid #1e7e34; }
        .btn-report { background: #007bff; border-bottom: 3px solid #0056b3; margin-top: 5px; }
        #log { font-size: 11px; color: #acc6e6; margin-top: 10px; background: rgba(0,0,0,0.3); padding: 10px; border-radius: 4px; border-left: 3px solid #28a745; }
        
        /* Floating Speedometer */
        #speed-dash {
            position: absolute; top: 15px; right: 15px; background: rgba(0,0,0,0.85);
            color: #00ff00; padding: 15px; border-radius: 10px; border: 2px solid #444;
            z-index: 2000; font-family: 'Courier New', monospace; min-width: 140px; text-align: center;
        }
    </style>
</head>
<body>

<div id="speed-dash">
    <div style="font-size: 11px; color: #ccc;">LIVE TRACK SPEED</div>
    <div id="live-speed" style="font-size: 32px; font-weight: bold;">00.0</div>
    <div style="font-size: 11px; color: #ccc;">KMPH</div>
</div>

<div id="sidebar">
    <h2 style="border-bottom: 2px solid #d93025; padding-bottom: 10px; font-size: 18px;">SECR AUDIT TOOL</h2>
    <label>FROM STATION</label><select id="s_from"></select>
    <label>TO STATION</label><select id="s_to"></select>
    <label>RTIS DATA (CSV)</label><input type="file" id="csv_file">
    
    <button onclick="drawMap()">GENERATE MAP</button>
    <button class="btn-report" onclick="getReport()">GENERATE REPORT</button>
    
    <div id="log">System Ready. Stage-02 Modular Mode.</div>
</div>

<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="mapping.js"></script>
<script src="report.js"></script>

<script>
    // These functions connect the UI to the external JS files
    function drawMap() { generateLiveMap(); }
    function getReport() { generateAuditReport(); }
</script>

</body>
</html>
